meta:
  name: "Capstone IDS Rules"
  version: "1.0"
rules:
  - id: R1001
    name: "Blocklisted IP"
    when:
      src_ip_in: ["203.0.113.10", "198.51.100.42"]
    severity: 7
    description: "Traffic from known bad IP"
  - id: R1002
    name: "Suspicious Port Scan"
    when:
      dst_ports_over_n_unique: 20
      window_seconds: 10
    severity: 6
    description: "Single source touching many ports quickly"
  - id: R1003
    name: "Keyword in Payload"
    when:
      payload_contains_any: ["select ", "union ", "or 1=1", "wget ", "curl "]
    severity: 5
    description: "SQLi or download attempt keyword"
  - id: R1004
    name: "High SYN Ratio"
    when:
      syn_ratio_over: 0.8
      min_packets: 10
    severity: 5
    description: "Likely SYN scan or half-open behavior"
